<html>
  <head>
<!-- https://developers.google.com/chart/interactive/docs/animation?hl=en#Supported_Modifications -->
<!-- https://developers.google.com/chart/interactive/docs/gallery/columnchart -->
<!-- https://developers.google.com/chart/interactive/docs/animation#Transition_Behavior -->



    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script src="js/extraFunctions.js"></script>
   		<script src="js/jquery-1.9.1.min.js"></script>
  		<script src="js/jquery.autocomplete.min.js"></script>
  		<script src="js/countries.js"></script>
		<!-- <script src="js/obj.js"></script> -->
		<script src="js/sampleD.js"></script>
		<script src="js/extraFunctions.js"></script>

    <script type="text/javascript"> 

      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(init);


   function init() {
		var options = {
		  width: 400,
		  height: 240,
		  animation: {
			duration: 1000,
			easing: 'out'
		  }
		};

	   var criteria = [];


	   function addCriteria(c) {
			 criteria.push(c);
		}
	   
	   
	   
		function removeCriteria(c) {
			for(var i = criteria.length - 1; i >= 0; i--) {
				if(criteria[i] === c) {
					criteria.splice(i, 1);
					 break;
				}
			}
		}
		
		
		

		var countries = [];
		var country="";

		
		
		
		function addCountry(c) {
			 countries.push(c);
		}
	   

		



		function removeCountry(c) {
			for(var i = countries.length - 1; i >= 0; i--) {
				if(countries[i] === c) {
				countries.splice(i, 1);
				break;
				}
			}
		}

		


		
		
		var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
		var data = new google.visualization.DataTable();
		data.addColumn('string', 'x');

		var addCountryButton = document.getElementById('b1');
		var removeCountryButton = document.getElementById('b2');
		var addCriteriaButton = document.getElementById('addCriteria');
		var removeCriteriaButton = document.getElementById('removeCriteria');



		function drawChart() {

			google.visualization.events.addListener(chart, 'ready',
			function() {


	//check to see if there are more criteria to add
			addCriteriaButton.disabled = false;
			removeCriteriaButton.disabled = false;


	//----------------------------------------------
			 });
			chart.draw(data, options);
		}
		
		

		
		
		
		

		addCountryButton.onclick = function() {
			var toAdd=document.getElementById('autocomplete').value;
			addCountry(toAdd);
			data.addColumn('number', toAdd);
			for (var i=0;i<criteria.length;i++){
				var currentCriteria=criteria[i];
				for (var search=0;search<fullDataSet.length;search++){
					if(fullDataSet[search]["Country"]==toAdd){
						var valueForCurrentCountry=fullDataSet[search][currentCriteria];
						break;
					}
				}
				data.setValue(i,data.getNumberOfColumns()-1,valueForCurrentCountry); 
			}
			
			drawChart();
		}


		removeCountryButton.onclick = function() {
			for (var curr=countries.length-1;curr>=0;curr--){
				var toRemove=document.getElementById('autocomplete').value;
				if(countries[curr]==toRemove){
					removeCountry(toRemove);
					data.removeColumn(curr+1);
				}
			}
			drawChart();
		}
		
		
		

		addCriteriaButton.onclick = function() {
			var criteriaToAdd=$("#sel option:selected").text();
			var arr = [];
			arr[0]=criteriaToAdd;
			for(var r=0;r<countries.length;r++){
				var currentCountry=countries[r];
				for(var searchData=0;searchData<fullDataSet.length;searchData++){
					if(fullDataSet[searchData]["Country"]==currentCountry) {
						var columnToAdd=fullDataSet[searchData][criteriaToAdd];
						arr[r+1]=columnToAdd;
						break;
					}
				}
			}
			addCriteria(criteriaToAdd);
			data.addRow(arr);
			drawChart();
		}

		
		
		

		removeCriteriaButton.onclick = function() {
			var criteriaToRemove=$("#sel option:selected").text();
			for (var curr=criteria.length-1;curr>=0;curr--){
				if(criteria[curr]==criteriaToRemove){
					removeCriteria(criteriaToRemove);
					data.removeRow(curr);

				}
			}
			drawChart();
		}

	drawChart();

	}





    </script>

  </head>
  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
    <button type="button" id="b1" >Add country!</button>
    <button type="button" id="b2" >Remove country!</button>
    <button type="button" id="addCriteria" >Add criteria!</button>
    <button type="button" id="removeCriteria" >Remove criteria!</button>


        <div id="bar1">
	<form> 
	<select id="sel">
		<option>GDP2011</option>
		<option>pop2010</option>
		<option>Continent</option>
		<option>Gold</option>
		<option>Silver</option>
		<option>Bronze</option>
	</select>
    </form>   
   </div> 


<form>
<input type="text" name="country" class="biginput" id="autocomplete" value="Enter Country" onblur="if(this.value=='')this.value='Enter Country';" onfocus="if(this.value=='Enter Country')this.value='';"/></form>

  </body>
</html>
